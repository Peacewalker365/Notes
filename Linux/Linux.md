# Linux
### Installation
- [ ] VMware
### Partition Editior
	1. 主分区最多只能有4个
	2. 扩展分区只能有一个
		1. 主分区加扩展分区只能有4个
		2. 扩展分区不能写入数据 只能包含逻辑分区 逻辑分区内可以写入数据
	3. 格式化（高级格式化）又称逻辑格式化 
		1. 格式化的目的就是为了写入
		2. 就像把柜子中打入隔断（遵守某种规则划分block）
		3. 当用户读取文件的时候 调用分区表 每个文件有一个inode 从而找到对应文件
		4. 格式化就是制定和实行这一种特定的规则 并创造inode表的过程
	4. 建立硬件设备文件（自动的 但我们要看懂）
		1. 第一子目录dev下 （linux一切皆文件）
		2. IDE硬盘 _dev_hd/[a-d]
		3. SCSI_SATA_USB硬盘 _dev_sd/[a-p]
		4. 等等......
	5. 分区设备文件名
		1. _dev_hda1（IDE硬盘接口）
		2. 等等........
	6. 挂载（类似win下的分配盘符，写入挂载点）
		1. 必须分区
			1. 根分区
				- [ ] 保证有地方可以写入
			2. swap分区（其实就是虚拟内存 交换分区 一般设置内存2倍 ）
			- [ ] 当根分区不足时 有备用分区写入
			2. 推荐分区
				1. /boot（启动分区）专门保存启动时的数据 以防根分区满了 无法启动
	7. 文件系统结构
		1. /
			1. /boot
			2. /etc
				1. passwd
				2. shadow
				3. group
			3. /home
		2. 注意
			1. linux可以给任意文件层级分配分区
			2. 比如给_分配_dev_sda3 然后给_home分配dev/sda2 等等


### 远程登录管理
- [ ] 联网
	1. 桥接（利用真实网卡，人多可能有IP地址冲突）
	2. host only
	3. VMnet
- [ ] 配置网卡
	- [ ] ifconfig -ens0 192.168.118.2
		- [ ] 虚拟机的网卡一定要和host在一个网段 否则无法通信
		- [ ] 注意 这种方法只是临时生效 重启之后就会reset
- [ ] 远程连接工具
	- [ ] SecureCRT
		1. quick connect
		2. Username: root
			- [ ] 一般不推荐用root登陆，因为权限过大，容易出问题，最好用一个普通账户登录
		3. 选择带save的
		4. 进入了之后即可进入远程操控
		5. 操作谨慎，例如关机重启更改ip地址
		6. 如果有乱码 把字体改成任何一个中文字体 让他包含乱码的字符集，然后刷新
		7. 输入df 查看分区情况
	- [ ] Winscp 文件拷贝工具
		1. 登陆 文件协议 SFTP
		2. 图形化界面 带加密 简单安全
	- [ ] xshell或者xftp


### 注意事项
	1. Linux区分大小写
	2. Linux中所有文件以稳健的形式保存，包括硬件！一切皆文件
	3. Linux不靠扩展名区分文件 靠的是文件权限
		1. 注意：有一些为了使用方便的扩展名是给操作者看的 实际linux不需要
		2. 压缩包 gz bz2 配置文件conf 脚本文件sh
		3. 安全 因为病毒没有执行权限
	4. Linux所有存储设备都必须挂在之后才能使用，包括硬盘 u盘 光盘

### 服务器的维护和建议
	1. Linux各目录的作用
		1. _bin_ 存放系统命令的目录，普通用户和超级用户都可以执行。不过放在/bin下的命令在单用户模式下也可以执行
		2. _sbin_ 保存和系统环境设置相关的命令，只有超级用户才可以使用他们进行系统环境设置
		3. _usr_bin/ 存放系统命令的目录，普通用户和超级用户都可以执行，这些命令和系统启动无关，在单用户模式下无法执行
		4. _usr_sbin/ 存放根文件系统不必要的系统管理命令，例如多数服务程序，只有超级用户可以使用
		5. _boot_ 系统启动目录，保存系统启动相关的文件，如内核文件和启动引导程序（grub）文件等 强烈建议备份
		6. _dev_ 设备文件的保存位置
		7. _etc_ 配置文件的保存位置，系统内所有采用默认安装方式（rpm安装）的服务配置文件全都保存在这个目录当中，如用户账户密码，服务的启动脚本，常用服务的配置文件等 强烈建议备份
		8. _home_ 普通用户的家目录
		9. _lib_ 系统调用函数库保存位置
		10. _lost+found_ 当系统以外崩溃或机器意外关机，会产生一些文件碎片在这里，可以用作备份恢复等
		11. _media_ 挂载目录 挂在额外设备
		12. _mnt_ 挂载目录挂载NFS服务的共享目录
			1. 注意 只有空目录才能作为挂载点
			2. 挂哪都行
		13. _misc_ 挂载目录 不大用
		14. _opt_ 第三方安装的软件的保存位置，不过现在已吧还是把软件放在usr_local_中，算是业内的潜规则
		15. _proc_ 虚拟文件系统 该目录中的数据并不保存在硬盘里 在内存里 主要是内存的进程 内核 设备状态 cpu信息等等等等
		16. _sys_ 内核相关 虚拟文件系统 在内存中
		17. _root_ 超级用户的家目录
		18. _srv_ 服务数据目录 服务 应用在启动之后产生的一切数据
		19. _tmp_ 临时目录 系统存放的临时文件 最好每次开机后清空
		20. _usr_ 系统软件资源目录 注意usr不是user的缩写 而是 Unix Software Resource的缩写 系统中安装的软件大多数都保存在这里
		21. _var_ 动态数据保存位置 其实就是日志 邮件等 主要保存缓存 日志以及软件所产生的文件
	2. 服务器注意事项
		1. 远程服务器不许关机，只能重启...因为远程关了没法开
			1. 推荐使用shutdown -r now
			2. 在重启前 进行几次-sync
		2. 重启时应正确关闭服务！
		3. 不要再服务器访问高峰运行高负载命令
		4. 远程配置防火墙时不要把自己踢出服务器
			1. 防火墙是个门岗 过滤器，靠ip地址 mac号 端口 协议类型 数据包中的数据等等 并不能防病毒 不能替代放毒软件
			2. 配置不好 可能把自己踢出去了 那就凉了
				1. 有一个笨办法 设置每五分钟清空防火墙设置 知道配置结束 以防把自己踢出去进不来了
		5. 制定合理的密码规范并定期更新
		6. 合理分配权限
			1. 在够用的情况下尽可能少 就像系统启动的服务越少越好
		7. 定期备份重要数据和日志
			1. 鸡蛋不要放在同一个篮子里

## Linux常用命令
### 1. 文件处理命令
	1. 命令格式与目录处理命令ls
		1. 

### 2. 权限管理命令


### 3. 文件搜索命令


### 4. 帮助命令


### 5. 用户管理命令


### 6. 压缩解压命令


### 7. 网络命令


### 8. 关机重启命令

——————————————
分割线———此处之后换了教程
——————————————


### 开源软件
Apache — web服务器
Nginx — web服务器
MySQL — 数据库（SQLsever，Oracle贵）
Samba — Linux和windows之间的内网文件服务器
MongoDB/redis — NoSQL数据库（不遵守SQL规则 辅助MySQL）
Sphinx — 中文分词（主要是用来做搜索引擎）（见喜欢迎 —> 见喜｜欢迎）

	1. 免费
	2. 可以获得源代码
	3. 自由传播，改良，甚至销售

支撑互联网的开源技术LAMP or LNMP：Linux Apache/Nginx MySQL PHP
现在还是这样么？ 需要验证

### 二级目录
	1. usr_lib_ 应用程序调用的函数库保存位置
	2. usr_local_ 安装位置 手工安装软件保存位置，一般建议把源码包软件安装在这个位置
	3. usr_share_ 应用程序的资源文件，如帮助文档，说明文档和字体目录
	4. usr_src_ 源程序位置 我们手动下载的源码包和内核源码包可以保存在这里 不过我觉得 usr_local_src/ 好像更好 这样可以跟内核分开放
	5. usr_src_kernels/ 内核源码的保存位置
	6. _var_www_html_ rpm包安装的Apache的网页主目录
	7. _var_lib/ 程序运行时需要调用或改变的数据保存位置，如MySQL的数据保存在_var_lib_mysql_中
	8. _var_log/ 系统日志的保存位置
	9. _var_run/ 一些服务和程序运行后，它们的PID（进程ID）保存位置。是_run_目录的软链接
	10. _var_spool/ 防止队列数据的目录，就是排队等待其他程序使用的数据，比如邮件队列和打印队列
	11. _var_spool_mail_ 新收到的邮件队列保存位置，系统新收到的邮件回保存在这里
	12. _var_spool_cron_ 系统的定时任务队列保存位置，系统的计划任务会保存在这里


## 常用命令
### 命令的基本格式
1. 命令的提示符
	- [ ] [root@localhost ~] #
	- [ ] []：这是提示符的分隔符号，没有特殊含义
	- [ ] root：显示当前的登录用户
	- [ ] @：分隔符号 没有特殊含义
	- [ ] localhost：当前系统的简写主机名 完全的主机名可以通过hostname查看
	- [ ] ~：当前所在目录的最后一级目录
	- [ ] 井号是超级用户的命令提示符 $是普通用户的

2. 命令的基本格式
	- [ ] 命令  [选项] [参数]
	1. ls -l
		1. 七列数据
			1. 权限
			2. 引用计数
				1. 文件的引用计数代表该文件的硬链接个数
				2. 目录的引用计数代表该目录有多少个一级子目录（注意 有隐藏子目录）
			3. 所有者 默认为文件的创建者
			4. 所属组 默认所属组是文件建立用户的有效组，一般情况下是建立用户的所属组
			5. 文件大小 默认单位byte
				1. -h 人性化显示 自动优化大小显示
			6. 修改时间和访问时间中最紧的
			7. 文件名
**选项是用于调整命令的功能的**
	ls下支持的部分常用选项
		-a 显示所有文件
		—color=when 支持颜色输出 when的默认值是always，也可以是never或者auto
		-d 显示目录信息，而不是目录下的文件
		-h 人性化显示 按照我们的习惯显示文件大小
		-i 显示文件的i节点号
		-l 长格式显示
		等等

**参数是命令的操作对象，如果省略参数，是因为有默认参数**

### 目录操作命令
1. ls命令
2. cd命令
	1. change directory
	2. 绝对路径和相对路径
		1. 绝对路径：以根目录为参照物，从根目录开始一级一级进入目录
		2. 相对路径：以当前目录作为参照物进行目录查找
	3. cd后面参数从/开始就是绝对路径 否则就是相对目录 新手建议用绝对命令
	4. 简化用法
		1. ~代表用户的家目录
		2. -代表上次目录
		3. .代表当前目录
		4. ..代表上级目录
	5. pwd 显示当前路径
3. mkdir新建目录
	1. 除了家目录和临时目录最好不要新建目录 不安全
	2. make directories
	3. -p递归建立所需目录
		1. mkdir 123/234/345
		2. 一级一级的递归建立
4. rmdir命令
	1. remove empty directories
	2. 只能删除空目录
	3. -p递归删除
	4. 并不推荐使用 太垃圾
5. rm命令
	1. rm -r 123 递归删除（询问）
		1. 进入到最深的空文件然后一级一级上级删除
	2. rm -rf 123
		1. 删除了目录本身
		2. 非常危险！
		3. 不会进入回收站
		4. 用的时候先想清楚 否则手快过大脑就gg
		5. 建议预先安装extundelete实现linux下文件和文件夹的数据恢复！！就算这样都不一定能恢复
	3. 如果不要删除当前目录，只删除当前目录下的所有子文件
		1. rm -rf 123/*
			1. 星号为通配符 可为任意内容


### 文件操作命令
1. touch命令
	1. change file timestamps
	2. 创建空文件或或修改文件的时间戳
2. stat命令
	1. status
	2. 显示文件或文件系统的详细信息
	3. 注意linux是不记录创建时间的
	4. 注意modify和change的区别
3. cat命令
	1. concatenate
	2. 查看文件内容
	3. -n显示行号
	4. -E列出每行结尾的回车符$
	5. -v列出特殊字符
	6. -T把tab用^I显示出来
	7. -A相当于 -vET 用于列出所有隐藏符
	8. 有些文件太大了 用cat不行 cat只适合看小文件
4. more命令
	1. 分屏显示文件的命令
	2. 用来显示cat无法显示的大文件
	3. 交互
		1. 空格 向下翻页
		2. b 向上翻页
		3. 回车 向下滚动一行
		4. /字符串 搜索制定字符串
		5. q 退出
5. less命令
	1. 分行显示文件的命令
	2. 交互
		1. 上下 一行一行翻
		2. q 退出
6. head命令
	1. 显示文件头	
	2. -n 行数：显示制定行数
	3. -f：监听 不会退出文件 如果其他终端往里写数据了 会继续显示新增内容 要用ctrl+c退出
7. tail命令
	1. 显示文件尾
	2. -n 行数：显示制定行数
8. ln命令
	1. link
	2. make links between files
	3. inode
		1. inode#
		2. 时间
		3. 权限
		4. block的位置
	4. block
		1. 储存了子文件的文件名和inode
	5. 所以如果我要查d文件的inode号， 我需要找到它的上级文件的block，在查询d的inode号...层层递归。所以要从根目录开始，根目录的inode号是固定为2（1在创建内核的时候被占用了）
	6. 硬链接
		1. 源文件和硬链接会拥有相同的inode和block
		2. 引用计数增加
		3. 修改其中一个 另一个都改变
		4. 删除任意一个文件 另一个都可用
		5. 硬链接标记不清，很难确认硬链接文件位置 不建议使用
		6. 硬链接 不能链接目录 因为链一个目录 所有子文件都要链 所以linux不让瞎搞
		7. 硬链接不能跨分区 俩文件要zhi xiang同一个分区的同一个inode
		8. 两东西其实是一个文件 只是名字不同而已 就像一个教室两个门 前门进人人数改变 后面进人人数也改变 堵上一个门 一样能进教室
	7. 软链接 ln -s
		1. 软链接和源文件拥有不同的Inode和Block
		2. 引用计数不会增加
		3. 任意修改一个 另一个都改变
		4. 删除软链接，源文件不受影响，删除源文件，软链接不能使用
		5. 软链接没有实际数据，只保存源文件的Inode，不论源文件多大，软链接的大小不变
		6. 软链接的权限是最大权限lrwxrwxrwx，但是由于没有实际数据，最终访问时要参考源文件权限
		7. 软链接可以链接目录
		8. 也可以跨分区
		9. 软链接的标记特征明显 推荐使用
		10. 软链接移动要写绝对路径！！！！！否则很容易出错
		11. 其实可以理解成快捷方式 是为了照顾老手的使用习惯 因为很多升级改变了文件的位置 不好找

### 目录和文件都能操作的命令
1. rm命令
	1. -f：强制删除
	2. -i：交互删除 默认情况下就是
	3. -r：递归删除，可以删除目录
2. cp命令
	1. cp [选项] 源文件 目标文件
	2. copy
	3. -r递归复制 用于复制目录
	4. -a 相当于 -dpr 保证目标文件和源文件一模一样
	5. -d 如果源文件为软链接，则复制出的目标也为软链接
	6. -i 如果目标文件已经存在，则会询问是否覆盖
	7. -p 复制后目标文件保留源文件的属性，包括所有者 所属组 权限和时间
3. mv命令
	1. move
	2. 移动或重命名
	3. 移动目录不需要加-r
	4. mv 123 _tmp_ 把123这个文件或者目录原名移动到tmp文件下
	5. mv 123 234 把123重命名为234


### 基本权限管理
1. 权限介绍
	1. 带.的 表示受SELinux 保护的文件
	2. 共10项
		1. 文件的类型
			1. 具体类型 info ls查询
			2. 主要类型
				1. -：普通文件
				2. d：目录
				3. l：软链接
				4. 剩下的相对较常见的还有 b 块设备文件比如内存c 设备文件比如鼠标键盘 p 管道服务文件s 套接字文件 千万别动 例如可能导致要重装php或mysql
		2. 2-4 所有者权限
		3. 5-7 所属组权限
		4. 8-10 其他
		5. rwx分别代表读写执行权限
		6. 所有者权限优先于所属组权限
2. 基本权限命令
	1. chmod
	2. chmod [ugoa] [[+-=] [perm]]
		1. change file mode bits
		2. 赋予方式
			1. +
			2. -
			3. =
			4. 例子
				1. chmod u+x bcd 给bcd的所有者添加执行权限
				2. chmod g+w，o+w bcd
				3. chmod u-x，g-w，o-w bcd
				4. chmod u=rwx bcd
		3. 数字权限
			1. 4代表r
			2. 2代表w
			3. 1代表x
			4. 例子
				1. chmod 755 bcd
		4. 常用权限
			1. 644 基本权限
			2. 755 文件的执行权限和目录的基本权限
			3. 777 除了系统自带的 不允许手动赋予777 会造成安全隐患
				1. 有时候改了改了开源软件放进apache 报错权限不足，为了省事所以被改成了777，造成安全隐患
	3. chown命令
		1. change file owner and group
		2. chown [选项] 用户:所属组 文件或目录
			1. 也可用.分隔
		3. 注意：普通用户可以修改所有者是自己的文件的权限
		4. 注意：普通用户不能修改文件的所有者 哪怕是属于当前用户的文件 只有超级用户能修改所有者和所属组
		5. 测试
			1. 在root超级用户下
			2. 先添加用户 useradd user1
				1. 注意 添加用户就会自动添加进自动创建的同名组
			3. passwd user1
			4. 此处输入密码
			5. chown user1 bcd
	4. chgrp命令
		1. 修改所属组

3. 基本权限的作用（难点）
	1. 权限对文件的作用
		1. r：cat more less head tail等文件查看命令
		2. w：vim echo等修改文件数据的命令
			1. 注意：对文件有写权限 是不能删除文件的
			2. 如果想要删除文件，需要对文件的上级目录有写权限！原理是文件的原理 inode和block的内容，文件名和其对应的inode是存在于上级目录的block中的，而权限是针对inode所对应的block的，也就是说，对block的权限是储存在inode中的
		3. x：对文件来说执行权限是最高权限 也是风险最高的 代表该文件有了执行权限 是否能正确执行 不一定
	2. 权限对目录的作用
		1. r：ls
		2. w：touch rm cp mv等
			1. 对目录来说写是最高权限
		3. x：目录是不能执行的，但是如果目录拥有执行权限 对应到命令上就是可进入 可以执行cd命令
	3. 目录的可用权限
		1. 0:没有任何权限
		2. 5:基本的目录浏览和进入权限
		3. 7:完全权限
			1. 没有什么6权限 因为不能进入 拥有写权限没有意义
	4. 注意：权限对超级用户是没有意义的 不管怎么样实际都是777



### umask默认权限

1. 查看系统的umask权限
   - 默认用八进制数值显示umask的权限
     - 0022
     - 暂时我们忽略第一个数
     - 后面依次是022
     - 即
   - -S 用字母表示文件和目录的权限
2. umask权限的计算方法
   1. 新建文件的默认最大权限
      - 666
      - 执行权限对文件比较危险，不能在新建时默认赋予，必须用户手动赋予
   2. 新建目录的默认最大权限
      - 777
      - 执行权限就是进入目录，所以默认赋予
   3. 官方标准算法
      - umask需要使用二进制进行逻辑与和逻辑非联合运算得到正确的默认权限
        1. 将总权限（目录777 文件666）和umask转换为2进制
        2. 对umask取反
        3. 对两个值做与
        4. 转换为十进制即权限
      - 但我们可以这样理解
        - umask是我们希望从默认最大权限中去掉的权限
        - 如果本来有 则去掉
        - 如果本来就没有 维持原样
        - 所以 对文件来说 umask 033和022的结果都是644
   4. 注意
      - 要永久更改umask 要写入配置文件
        - /etc/profile
        - 环境变量配置文件
      - 否则都是暂时的更改



### 帮助命令

1. man命令
   1. manual
   2. man [命令]
   3. 快捷键
      1. 上下 移动一行
      2. PgUp PgDn 翻页
      3. g 第一页
      4. G/shift+g 最后一页
      5. q 退出
      6. /字符串 从当前向下搜索
      7. ？字符串 从当前向上搜索
      8. N 当搜索字符串时 使用N反向搜索
   4. 帮助级别
      1. 默认打开1级别 绝大部分命令只有1级别的
      2. 帮助级别
         1. 普通用户可以执行的系统命令和可执行文件的帮助
         2. 内核可以调用的函数和工具的帮助
         3. C语言函数的帮助
         4. 设备和特殊文件的帮助
         5. 配置文件的帮助
         6. 游戏的帮助
         7. 杂项的帮助
         8. 超级用户可执行的系统命令的帮助
         9. 内核的帮助
      3. man -f 命令 或者 whatis 命令
         - 查看命令拥有哪个级别的帮助
         - 小tip：新系统或者刚恢复快照 可能用whatis报错 可用makewhatis 解决
      4. man -k 命令 或者 apropos 命令
         - 查看命令相关的所有帮助
         - 只要包含命令的字符串都会被找到   不常用
2. info命令
   1. info命令比man更详细，是一套完整的资料
   2. 如果man找不到有用的信息，在用info
3. help命令
   1. 只能获取shell内置命令的帮助
   2. 作用很有限 一般不用
4. --help选项
   1. 绝大多数命令都可以使用--help选项来查看帮助
   2. 输出的帮助信息基本是man的简化版
   3. 例如 ls --help



### 搜索命令

1. whereis命令

   1. 搜索命令的命令 不能搜索文件
   2. 搜索位置和帮助文档的位置

2. which命令

   1. 搜索命令的命令 不能搜索文件
   2. 搜索位置和灵命的别名

3. locate命令

   1. 按照文件名搜索普通文件的命令
   2. 优点：按照数据库搜索，速度快，消耗资源少，数据库位置/var/lib/mlocate/mlocate.db
   3. 缺点；只能按照文件名来搜索文件，不能执行更复杂的搜索
   4. 注意：搜索前先更新库 updatedb 否则刚产生的文件夹可能找不着
   5. 注意：配置文件里会排除一些文件和目录 例如tmp下的文件是搜不到的
   6. 常用

4. find命令

   1. 按照文件名搜索

      1. -name

         - find [路径] -name [文件名]

         - 严格区分大小写

      2. -iname

         - 不区分大小写

      3. -inum

         - 按照inode去搜索文件

   2. 按照文件大小搜索

      1. -size
         - find . -size -15
           - 默认单位b 512字节
           - c for byte
           - w for 2字节
           - k for KB
           - M for MB
           - G for GB
           - 大小之前- 代表小于

   3. 按照修改时间搜索

      1. -atime 访问时间
      2. -mtime 修改时间
      3. -ctime 状态修改时间
      4. 前三个时间单位为天
      5. -amin -mmin -cmin 以分钟为单位
      6. 格式：find . -atime +5
         - -5 五天内
         - 5 五到六天前的那24小时
         - +5 六天之前

   4. 按照权限来搜索

      1. -perm
         - 支持+—
         - +444 搜索包含444种任意一个组的权限的文件 三个数任意一个大于等于4
         - -444 搜索全部包含权限模式的文件 三个数全部大于等于4
         - 444 搜索搞好等于权限模式的文件

   5. 按照所有者和所属组搜索

      1. -uid
      2. -gid
      3. -user
      4. -group
      5. -nouser 查找没有所有者文件 即外来文件 如光盘和U盘等 否则一般是垃圾文件 常用来搜索垃圾文件

   6. 按照文件类型搜索

      1. find . -type d abc 查找目录
      2. -type f 普通文件
      3. -type l 软连接文件

   7. 逻辑运算符

      - find 搜索路径 选项 搜索内容

      1. -a 与
         - find . -size +2k -a -type f
      2. -o 或
      3. -not 或者!   非

   8. 其他选项

      1. -exec

         - find 搜索路径 选项 搜索内容 -exec 命令2 {} \;

         - 把find命令的结果交给由-exec调用的命令2来处理 {}就代表find命令的查找结果
         - find . -size +2k -a -type f -exec ls -lh {} \;
         - 注意命令2不支持别名

      2. -ok

         - 区别是每执行一次命令2 就询问一次
         - -exec就直接处理了
         - -ok 比-exec适合执行删除

5. grep命令

   1. 用于在文件中搜索符合条件的字符串
   2. 如果需要模糊搜索，使用正则表达式进行匹配
   3. 选项
      1. -i 忽略大小写
      2. -n 输出其在原始文件里的行号
      3. -v 取反
      4. --color=auto 搜索的字符串红色高亮
   4. [目前进度](https://www.bilibili.com/video/BV1ut411a7ro?p=34)

